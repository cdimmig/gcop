<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>GCOP: lib/systems/costs/lqsensorcost.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">GCOP
   &#160;<span id="projectnumber">1.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_a500c0d9ec76a5160e2e420ae78a2766.html">lib</a>      </li>
      <li class="navelem"><a class="el" href="dir_3d1c4eb1f88f1e305138f3f2d45ef2b1.html">systems</a>      </li>
      <li class="navelem"><a class="el" href="dir_3f7a34d4b8eb7a816ce0a2aa8dfd1908.html">costs</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">lqsensorcost.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="lqsensorcost_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef GCOP_LQSENSORCOST_H</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define GCOP_LQSENSORCOST_H</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;limits&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &quot;<a class="code" href="lssensorcost_8h.html">lssensorcost.h</a>&quot;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="keyword">namespace </span>gcop {
<a name="l00009"></a>00009   
<a name="l00010"></a>00010   <span class="keyword">using namespace </span>std;
<a name="l00011"></a>00011   <span class="keyword">using namespace </span>Eigen;
<a name="l00012"></a>00012   
<a name="l00013"></a>00013   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T = VectorXd, 
<a name="l00014"></a>00014     <span class="keywordtype">int</span> _nx = Dynamic, 
<a name="l00015"></a>00015     <span class="keywordtype">int</span> _nu = Dynamic,
<a name="l00016"></a>00016     <span class="keywordtype">int</span> _np = Dynamic,
<a name="l00017"></a>00017     <span class="keywordtype">int</span> _ng = Dynamic,
<a name="l00018"></a>00018     <span class="keyword">typename</span> Tz = VectorXd,
<a name="l00019"></a><a class="code" href="classgcop_1_1LqSensorCost.html">00019</a>     <span class="keywordtype">int</span> _nz = Dynamic&gt; <span class="keyword">class </span><a class="code" href="classgcop_1_1LqSensorCost.html">LqSensorCost</a> : <span class="keyword">public</span> <a class="code" href="classgcop_1_1LsSensorCost.html">LsSensorCost</a>&lt;T, _nx, _nu, _np, _ng, Tz, _nz&gt; {
<a name="l00020"></a>00020     <span class="keyword">public</span>:
<a name="l00021"></a>00021 
<a name="l00022"></a><a class="code" href="classgcop_1_1LqSensorCost.html#ab17b8680a0520ff28212bf0e8058d114">00022</a>   <span class="keyword">typedef</span> Matrix&lt;double, _ng, 1&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#ab17b8680a0520ff28212bf0e8058d114">Vectorgd</a>;
<a name="l00023"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a7a1c771ead648f34c9294d5ecab6e40c">00023</a>   <span class="keyword">typedef</span> Matrix&lt;double, _ng, _nx&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#a7a1c771ead648f34c9294d5ecab6e40c">Matrixgxd</a>;
<a name="l00024"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a2a382f2ea02c755b23a8978192d9f531">00024</a>   <span class="keyword">typedef</span> Matrix&lt;double, _ng, _nu&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#a2a382f2ea02c755b23a8978192d9f531">Matrixgud</a>;
<a name="l00025"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a046f84650db789164e285a3cda2c65a6">00025</a>   <span class="keyword">typedef</span> Matrix&lt;double, _ng, _np&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#a046f84650db789164e285a3cda2c65a6">Matrixgpd</a>;
<a name="l00026"></a><a class="code" href="classgcop_1_1LqSensorCost.html#aefe7e59d6db4847e894e9e4bec08d889">00026</a>   <span class="keyword">typedef</span> Matrix&lt;double, _ng, _nz&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#aefe7e59d6db4847e894e9e4bec08d889">Matrixgzd</a>;
<a name="l00027"></a>00027 
<a name="l00028"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a3c6ac29844b0ef8a974e4e9bac14e94a">00028</a>   <span class="keyword">typedef</span> Matrix&lt;double, _nx, 1&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#a3c6ac29844b0ef8a974e4e9bac14e94a">Vectornd</a>;
<a name="l00029"></a><a class="code" href="classgcop_1_1LqSensorCost.html#aed1f33b8783f28131375c67f7c56daa4">00029</a>   <span class="keyword">typedef</span> Matrix&lt;double, _nu, 1&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#aed1f33b8783f28131375c67f7c56daa4">Vectorcd</a>;
<a name="l00030"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">00030</a>   <span class="keyword">typedef</span> Matrix&lt;double, _np, 1&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a>;
<a name="l00031"></a>00031 
<a name="l00032"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a647a927eb52363a70d55f80c9bc75d38">00032</a>   <span class="keyword">typedef</span> Matrix&lt;double, _nx, _nx&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#a647a927eb52363a70d55f80c9bc75d38">Matrixnd</a>;
<a name="l00033"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a9e62ab993fba58cea3f7a9e4cc822d24">00033</a>   <span class="keyword">typedef</span> Matrix&lt;double, _nx, _nu&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#a9e62ab993fba58cea3f7a9e4cc822d24">Matrixncd</a>;
<a name="l00034"></a><a class="code" href="classgcop_1_1LqSensorCost.html#adf769e4993e30a901de4665374b345d1">00034</a>   <span class="keyword">typedef</span> Matrix&lt;double, _nu, _nx&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#adf769e4993e30a901de4665374b345d1">Matrixcnd</a>;
<a name="l00035"></a><a class="code" href="classgcop_1_1LqSensorCost.html#ab7fc73b205a5d561f198675c6723f2d8">00035</a>   <span class="keyword">typedef</span> Matrix&lt;double, _nu, _nu&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#ab7fc73b205a5d561f198675c6723f2d8">Matrixcd</a>;
<a name="l00036"></a>00036   
<a name="l00037"></a>00037   <span class="comment">//  typedef Matrix&lt;double, Dynamic, 1&gt; Vectormd;</span>
<a name="l00038"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a83c9f189479594ddfa891136aca91bf0">00038</a>   <span class="keyword">typedef</span> Matrix&lt;double, _np, _np&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#a83c9f189479594ddfa891136aca91bf0">Matrixmd</a>;
<a name="l00039"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a21c6b2e25f4f206edb31d692f3354190">00039</a>   <span class="keyword">typedef</span> Matrix&lt;double, _nx, _np&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#a21c6b2e25f4f206edb31d692f3354190">Matrixnmd</a>;
<a name="l00040"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a0b1b320c10a6b7106c0eb332c71f6df1">00040</a>   <span class="keyword">typedef</span> Matrix&lt;double, _np, _nx&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#a0b1b320c10a6b7106c0eb332c71f6df1">Matrixmnd</a>;
<a name="l00041"></a>00041       
<a name="l00042"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a3de9b3f07cce0167cf38c3bb54cb4469">00042</a>   <span class="keyword">typedef</span> Matrix&lt;double, _nz, 1&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#a3de9b3f07cce0167cf38c3bb54cb4469">Vectorrd</a>;
<a name="l00043"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a29de4b9a3ba7fee5f99d9a688f0ebabd">00043</a>   <span class="keyword">typedef</span> Matrix&lt;double, _nz, _nz&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#a29de4b9a3ba7fee5f99d9a688f0ebabd">Matrixrd</a>;
<a name="l00044"></a><a class="code" href="classgcop_1_1LqSensorCost.html#ac18c481007159515d25ca5e26aa52c39">00044</a>   <span class="keyword">typedef</span> Matrix&lt;double, _nz, _nx&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#ac18c481007159515d25ca5e26aa52c39">Matrixrnd</a>;
<a name="l00045"></a><a class="code" href="classgcop_1_1LqSensorCost.html#acac810128ac3b6053ccbafc47a60a87a">00045</a>   <span class="keyword">typedef</span> Matrix&lt;double, _nz, _nu&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#acac810128ac3b6053ccbafc47a60a87a">Matrixrcd</a>;
<a name="l00046"></a><a class="code" href="classgcop_1_1LqSensorCost.html#aac44a5660c6663f41f31c7303873ad97">00046</a>   <span class="keyword">typedef</span> Matrix&lt;double, _nz, _np&gt; <a class="code" href="classgcop_1_1LqSensorCost.html#aac44a5660c6663f41f31c7303873ad97">Matrixrmd</a>;
<a name="l00047"></a>00047 
<a name="l00056"></a>00056     <a class="code" href="classgcop_1_1LqSensorCost.html">LqSensorCost</a>(<a class="code" href="classgcop_1_1System.html">System&lt;T, _nx, _nu, _np&gt;</a> &amp; sys, <a class="code" href="classgcop_1_1Manifold.html">Manifold&lt;Tz, _nz&gt;</a>  &amp;Z, <span class="keywordtype">bool</span> diag = <span class="keyword">true</span>);
<a name="l00057"></a>00057 
<a name="l00062"></a>00062     <span class="keywordtype">void</span> UpdateGains(); 
<a name="l00063"></a>00063 
<a name="l00064"></a>00064     <span class="keywordtype">double</span> L(<span class="keywordtype">double</span> t, <span class="keyword">const</span> Tz &amp;z, <span class="keyword">const</span> <a class="code" href="classgcop_1_1LqSensorCost.html#a3c6ac29844b0ef8a974e4e9bac14e94a">Vectornd</a> &amp;w,
<a name="l00065"></a>00065                    <span class="keyword">const</span> <a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a> &amp;p, <span class="keywordtype">double</span> h, <span class="keywordtype">int</span> sensor_index, 
<a name="l00066"></a>00066                    <a class="code" href="classgcop_1_1LqSensorCost.html#a3c6ac29844b0ef8a974e4e9bac14e94a">Vectornd</a> *Lw = 0, <a class="code" href="classgcop_1_1LqSensorCost.html#a647a927eb52363a70d55f80c9bc75d38">Matrixnd</a>* Lww = 0,
<a name="l00067"></a>00067                    <a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a> *Lp = 0, <a class="code" href="classgcop_1_1LqSensorCost.html#a83c9f189479594ddfa891136aca91bf0">Matrixmd</a>* Lpp = 0,
<a name="l00068"></a>00068                    <a class="code" href="classgcop_1_1LqSensorCost.html#a3de9b3f07cce0167cf38c3bb54cb4469">Vectorrd</a> *Lz = 0, <a class="code" href="classgcop_1_1LqSensorCost.html#a29de4b9a3ba7fee5f99d9a688f0ebabd">Matrixrd</a>* Lzz = 0,
<a name="l00069"></a>00069                    <a class="code" href="classgcop_1_1LqSensorCost.html#a0b1b320c10a6b7106c0eb332c71f6df1">Matrixmnd</a> *Lpw = 0, <a class="code" href="classgcop_1_1LqSensorCost.html#ac18c481007159515d25ca5e26aa52c39">Matrixrnd</a>* Lzw = 0, <a class="code" href="classgcop_1_1LqSensorCost.html#aac44a5660c6663f41f31c7303873ad97">Matrixrmd</a>* Lzp = 0);  
<a name="l00070"></a>00070 
<a name="l00071"></a>00071     <span class="keywordtype">double</span> Lp(<span class="keyword">const</span> <a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a> &amp;p,
<a name="l00072"></a>00072                    <a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a> *Lp = 0, <a class="code" href="classgcop_1_1LqSensorCost.html#a83c9f189479594ddfa891136aca91bf0">Matrixmd</a> *Lpp = 0);
<a name="l00073"></a>00073 
<a name="l00074"></a>00074     <span class="keywordtype">bool</span> Res(<a class="code" href="classgcop_1_1LqSensorCost.html#ab17b8680a0520ff28212bf0e8058d114">Vectorgd</a> &amp;g, 
<a name="l00075"></a>00075                      <span class="keywordtype">double</span> t, <span class="keyword">const</span> Tz &amp;z,
<a name="l00076"></a>00076                      <span class="keyword">const</span> <a class="code" href="classgcop_1_1LqSensorCost.html#a3c6ac29844b0ef8a974e4e9bac14e94a">Vectornd</a> &amp;w, <span class="keyword">const</span> <a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a> &amp;p, 
<a name="l00077"></a>00077                      <span class="keywordtype">double</span> h, <span class="keywordtype">int</span> sensor_index,
<a name="l00078"></a>00078                      <a class="code" href="classgcop_1_1LqSensorCost.html#a7a1c771ead648f34c9294d5ecab6e40c">Matrixgxd</a> *dgdw = 0, <a class="code" href="classgcop_1_1LqSensorCost.html#a046f84650db789164e285a3cda2c65a6">Matrixgpd</a> *dgdp = 0,
<a name="l00079"></a>00079                      <a class="code" href="classgcop_1_1LqSensorCost.html#aefe7e59d6db4847e894e9e4bec08d889">Matrixgzd</a> *dgdz = 0);    
<a name="l00080"></a>00080 
<a name="l00081"></a>00081     <span class="keywordtype">bool</span> Resp(<a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a> &amp;gp, 
<a name="l00082"></a>00082                    <span class="keyword">const</span> <a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a> &amp;p,
<a name="l00083"></a>00083                    <a class="code" href="classgcop_1_1LqSensorCost.html#a83c9f189479594ddfa891136aca91bf0">Matrixmd</a> *dgdp = 0);    
<a name="l00089"></a>00089     <span class="keywordtype">void</span> SetReference(<span class="keyword">const</span> vector&lt;Tz&gt; *zs, <a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a> *mup = 0);        
<a name="l00090"></a>00090     
<a name="l00091"></a>00091     <span class="comment">//const Tz &amp;zf; ///&lt; reference to a desired final state</span>
<a name="l00092"></a>00092     
<a name="l00093"></a><a class="code" href="classgcop_1_1LqSensorCost.html#acec83b65675aa809b4a1c14e1a11596e">00093</a>     <span class="keywordtype">bool</span> <a class="code" href="classgcop_1_1LqSensorCost.html#acec83b65675aa809b4a1c14e1a11596e" title="are the Q, Qf, and R matrices diagonal (true by default)">diag</a>;   
<a name="l00094"></a>00094     
<a name="l00095"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a50302ada540ff58374b7fe60e56e1af1">00095</a>     <a class="code" href="classgcop_1_1LqSensorCost.html#a29de4b9a3ba7fee5f99d9a688f0ebabd">Matrixrd</a> <a class="code" href="classgcop_1_1LqSensorCost.html#a50302ada540ff58374b7fe60e56e1af1" title="inverse of measurement covariance matrix">R</a>;       
<a name="l00096"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a091762065c9acbb0d308360b576f5dcf">00096</a>     <a class="code" href="classgcop_1_1LqSensorCost.html#a647a927eb52363a70d55f80c9bc75d38">Matrixnd</a> <a class="code" href="classgcop_1_1LqSensorCost.html#a091762065c9acbb0d308360b576f5dcf" title="inverse of noise covariance matrix">S</a>;       
<a name="l00097"></a><a class="code" href="classgcop_1_1LqSensorCost.html#aeeea209e36d87138a8d62ab6823a2498">00097</a>     <a class="code" href="classgcop_1_1LqSensorCost.html#a83c9f189479594ddfa891136aca91bf0">Matrixmd</a> <a class="code" href="classgcop_1_1LqSensorCost.html#aeeea209e36d87138a8d62ab6823a2498" title="inverse of parameter covariance matrix (set to zero if nothing is known about parameters before hand)...">P</a>;       
<a name="l00098"></a>00098 
<a name="l00099"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a8b0880ab43f3e2ac8742ab99bc24d110">00099</a>     <a class="code" href="classgcop_1_1LqSensorCost.html#a647a927eb52363a70d55f80c9bc75d38">Matrixnd</a> <a class="code" href="classgcop_1_1LqSensorCost.html#a8b0880ab43f3e2ac8742ab99bc24d110" title="S sqrt.">Ssqrt</a>;       
<a name="l00100"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a4db6e90aa622cab619bea218d703f0ce">00100</a>     <a class="code" href="classgcop_1_1LqSensorCost.html#a29de4b9a3ba7fee5f99d9a688f0ebabd">Matrixrd</a> <a class="code" href="classgcop_1_1LqSensorCost.html#a4db6e90aa622cab619bea218d703f0ce" title="R sqrt.">Rsqrt</a>;       
<a name="l00101"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a935c968b460d62555942f882228d8180">00101</a>     <a class="code" href="classgcop_1_1LqSensorCost.html#a83c9f189479594ddfa891136aca91bf0">Matrixmd</a> <a class="code" href="classgcop_1_1LqSensorCost.html#a935c968b460d62555942f882228d8180" title="P sqrt.">Psqrt</a>;       
<a name="l00102"></a>00102 
<a name="l00103"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a74f9de0aea13a563e3c617a097b6a8bd">00103</a>     <span class="keyword">const</span> vector&lt;Tz&gt; *<a class="code" href="classgcop_1_1LqSensorCost.html#a74f9de0aea13a563e3c617a097b6a8bd" title="measured sensor data">zs</a>;         
<a name="l00104"></a><a class="code" href="classgcop_1_1LqSensorCost.html#ab76e69010e78b148d1ad4c6a84246d92">00104</a>     <a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a> *<a class="code" href="classgcop_1_1LqSensorCost.html#ab76e69010e78b148d1ad4c6a84246d92" title="Prior for parameter data.">mup</a>;          
<a name="l00105"></a>00105 
<a name="l00106"></a>00106     <span class="keyword">protected</span>:
<a name="l00107"></a>00107 
<a name="l00108"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a9c75fa44702d77d012a6328a4f328293">00108</a>     <a class="code" href="classgcop_1_1LqSensorCost.html#a3de9b3f07cce0167cf38c3bb54cb4469">Vectorrd</a> <a class="code" href="classgcop_1_1LqSensorCost.html#a9c75fa44702d77d012a6328a4f328293" title="measurement error (as a tangent vector)">dz</a>;      
<a name="l00109"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a30e5d268de0a92b700a841322e838756">00109</a>     <a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a> <a class="code" href="classgcop_1_1LqSensorCost.html#a30e5d268de0a92b700a841322e838756" title="parameter error">dp</a>;      
<a name="l00110"></a>00110     };
<a name="l00111"></a>00111   
<a name="l00112"></a>00112     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> _nx, <span class="keywordtype">int</span> _nu, <span class="keywordtype">int</span> _np, <span class="keywordtype">int</span> _ng, <span class="keyword">typename</span> Tz, <span class="keywordtype">int</span> _nz&gt;
<a name="l00113"></a><a class="code" href="classgcop_1_1LqSensorCost.html#ad18ffa9630c50bc0880ae5b603ced4aa">00113</a>     <a class="code" href="classgcop_1_1LqSensorCost.html">LqSensorCost&lt;T, _nx, _nu, _np, _ng, Tz, _nz&gt;::LqSensorCost</a>(
<a name="l00114"></a>00114                                                     <a class="code" href="classgcop_1_1System.html">System&lt;T, _nx, _nu, _np&gt;</a> &amp;sys, 
<a name="l00115"></a>00115                                                     <a class="code" href="classgcop_1_1Manifold.html">Manifold&lt;Tz, _nz&gt;</a>  &amp;Z,
<a name="l00116"></a>00116                                                     <span class="keywordtype">bool</span> diag) : 
<a name="l00117"></a>00117     <a class="code" href="classgcop_1_1LsSensorCost.html">LsSensorCost</a>&lt;T, _nx, _nu, _np, _ng, Tz, _nz&gt;(sys, Z, sys.X.n + Z.n + sys.P.n), diag(diag) {
<a name="l00118"></a>00118     
<a name="l00119"></a>00119     <span class="keywordflow">if</span> (_nz == Dynamic || _nx == Dynamic || _np == Dynamic) {
<a name="l00120"></a>00120       <a class="code" href="classgcop_1_1LqSensorCost.html#a50302ada540ff58374b7fe60e56e1af1" title="inverse of measurement covariance matrix">R</a>.resize(Z.<a class="code" href="classgcop_1_1Manifold.html#a7f5bc8f44907e3e56e1f1780368bf5b0" title="dimension">n</a>, Z.<a class="code" href="classgcop_1_1Manifold.html#a7f5bc8f44907e3e56e1f1780368bf5b0" title="dimension">n</a>);
<a name="l00121"></a>00121       <a class="code" href="classgcop_1_1LqSensorCost.html#a091762065c9acbb0d308360b576f5dcf" title="inverse of noise covariance matrix">S</a>.resize(sys.<a class="code" href="classgcop_1_1System.html#a6593207bda11e47bef953071c5fea08f" title="state manifold">X</a>.n, sys.<a class="code" href="classgcop_1_1System.html#a6593207bda11e47bef953071c5fea08f" title="state manifold">X</a>.n);
<a name="l00122"></a>00122       <a class="code" href="classgcop_1_1LqSensorCost.html#aeeea209e36d87138a8d62ab6823a2498" title="inverse of parameter covariance matrix (set to zero if nothing is known about parameters before hand)...">P</a>.resize(sys.<a class="code" href="classgcop_1_1System.html#a216e7363c7d8944556cfd69c6f29ef27" title="parameter Euclidean manifold">P</a>.n, sys.<a class="code" href="classgcop_1_1System.html#a216e7363c7d8944556cfd69c6f29ef27" title="parameter Euclidean manifold">P</a>.n);
<a name="l00123"></a>00123 
<a name="l00124"></a>00124       <a class="code" href="classgcop_1_1LqSensorCost.html#a4db6e90aa622cab619bea218d703f0ce" title="R sqrt.">Rsqrt</a>.resize(Z.<a class="code" href="classgcop_1_1Manifold.html#a7f5bc8f44907e3e56e1f1780368bf5b0" title="dimension">n</a>, Z.<a class="code" href="classgcop_1_1Manifold.html#a7f5bc8f44907e3e56e1f1780368bf5b0" title="dimension">n</a>);
<a name="l00125"></a>00125       <a class="code" href="classgcop_1_1LqSensorCost.html#a8b0880ab43f3e2ac8742ab99bc24d110" title="S sqrt.">Ssqrt</a>.resize(sys.<a class="code" href="classgcop_1_1System.html#a6593207bda11e47bef953071c5fea08f" title="state manifold">X</a>.n, sys.<a class="code" href="classgcop_1_1System.html#a6593207bda11e47bef953071c5fea08f" title="state manifold">X</a>.n);
<a name="l00126"></a>00126       <a class="code" href="classgcop_1_1LqSensorCost.html#a935c968b460d62555942f882228d8180" title="P sqrt.">Psqrt</a>.resize(sys.<a class="code" href="classgcop_1_1System.html#a216e7363c7d8944556cfd69c6f29ef27" title="parameter Euclidean manifold">P</a>.n, sys.<a class="code" href="classgcop_1_1System.html#a216e7363c7d8944556cfd69c6f29ef27" title="parameter Euclidean manifold">P</a>.n);
<a name="l00127"></a>00127 
<a name="l00128"></a>00128       <a class="code" href="classgcop_1_1LqSensorCost.html#a30e5d268de0a92b700a841322e838756" title="parameter error">dp</a>.resize(sys.<a class="code" href="classgcop_1_1System.html#a216e7363c7d8944556cfd69c6f29ef27" title="parameter Euclidean manifold">P</a>.n);
<a name="l00129"></a>00129     }
<a name="l00130"></a>00130 
<a name="l00131"></a>00131     <a class="code" href="classgcop_1_1LqSensorCost.html#a50302ada540ff58374b7fe60e56e1af1" title="inverse of measurement covariance matrix">R</a>.setIdentity();
<a name="l00132"></a>00132     <a class="code" href="classgcop_1_1LqSensorCost.html#a091762065c9acbb0d308360b576f5dcf" title="inverse of noise covariance matrix">S</a>.setIdentity();
<a name="l00133"></a>00133     <a class="code" href="classgcop_1_1LqSensorCost.html#aeeea209e36d87138a8d62ab6823a2498" title="inverse of parameter covariance matrix (set to zero if nothing is known about parameters before hand)...">P</a>.setZero();<span class="comment">//Initial guess for parameters should be no prior</span>
<a name="l00134"></a>00134 
<a name="l00135"></a>00135     <a class="code" href="classgcop_1_1LqSensorCost.html#a4ab668e4c5702d359d076e15af0c617b">UpdateGains</a>();
<a name="l00136"></a>00136 
<a name="l00137"></a>00137     <a class="code" href="classgcop_1_1LqSensorCost.html#a74f9de0aea13a563e3c617a097b6a8bd" title="measured sensor data">zs</a> = 0;
<a name="l00138"></a>00138     <a class="code" href="classgcop_1_1LqSensorCost.html#ab76e69010e78b148d1ad4c6a84246d92" title="Prior for parameter data.">mup</a> = 0;
<a name="l00139"></a>00139   }
<a name="l00140"></a>00140   
<a name="l00141"></a>00141   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> _nx, <span class="keywordtype">int</span> _nu, <span class="keywordtype">int</span> _np, <span class="keywordtype">int</span> _ng, <span class="keyword">typename</span> Tz, <span class="keywordtype">int</span> _nz&gt;
<a name="l00142"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a4ab668e4c5702d359d076e15af0c617b">00142</a>     <span class="keywordtype">void</span> <a class="code" href="classgcop_1_1LqSensorCost.html#a4ab668e4c5702d359d076e15af0c617b">LqSensorCost&lt;T, _nx, _nu, _np, _ng, Tz, _nz&gt;::UpdateGains</a>() {
<a name="l00143"></a>00143     Rsqrt = R.array().sqrt();
<a name="l00144"></a>00144     Ssqrt = S.array().sqrt();
<a name="l00145"></a>00145     Psqrt = P.array().sqrt();
<a name="l00146"></a>00146   }
<a name="l00147"></a>00147 
<a name="l00148"></a>00148 
<a name="l00149"></a>00149   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> _nx, <span class="keywordtype">int</span> _nu, <span class="keywordtype">int</span> _np, <span class="keywordtype">int</span> _ng, <span class="keyword">typename</span> Tz, <span class="keywordtype">int</span> _nz&gt;
<a name="l00150"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a0ee7bcf22e6b5110543808b7fc1ae43b">00150</a>     <span class="keywordtype">void</span> <a class="code" href="classgcop_1_1LqSensorCost.html#a0ee7bcf22e6b5110543808b7fc1ae43b">LqSensorCost&lt;T, _nx, _nu, _np, _ng, Tz, _nz&gt;::SetReference</a>(<span class="keyword">const</span> vector&lt;Tz&gt; *zs, <a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a> *mup) {
<a name="l00151"></a>00151     this-&gt;zs = zs;
<a name="l00152"></a>00152     <span class="comment">//this-&gt;mup = mup;</span>
<a name="l00153"></a>00153     <span class="keywordflow">if</span>(mup)
<a name="l00154"></a>00154     {
<a name="l00155"></a>00155       this-&gt;mup = <span class="keyword">new</span> VectorXd(mup-&gt;size());
<a name="l00156"></a>00156       *(this-&gt;mup) = *mup;<span class="comment">//Copy the vector over</span>
<a name="l00157"></a>00157     }
<a name="l00158"></a>00158     <span class="comment">//Add assert statments to make sure there are enough measurements and parameters#TODO</span>
<a name="l00159"></a>00159   }
<a name="l00160"></a>00160 
<a name="l00161"></a>00161   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> _nx, <span class="keywordtype">int</span> _nu, <span class="keywordtype">int</span> _np, <span class="keywordtype">int</span> _ng, <span class="keyword">typename</span> Tz, <span class="keywordtype">int</span> _nz&gt;
<a name="l00162"></a><a class="code" href="classgcop_1_1LqSensorCost.html#aabfdbde9977b63eda6d705ea9e504f8b">00162</a>     <span class="keywordtype">bool</span> <a class="code" href="classgcop_1_1LqSensorCost.html#aabfdbde9977b63eda6d705ea9e504f8b">LqSensorCost&lt;T, _nx, _nu, _np, _ng, Tz, _nz&gt;::Res</a>(<a class="code" href="classgcop_1_1LqSensorCost.html#ab17b8680a0520ff28212bf0e8058d114">Vectorgd</a> &amp;g, 
<a name="l00163"></a>00163                      <span class="keywordtype">double</span> t, <span class="keyword">const</span> Tz &amp;z,
<a name="l00164"></a>00164                      <span class="keyword">const</span> <a class="code" href="classgcop_1_1LqSensorCost.html#a3c6ac29844b0ef8a974e4e9bac14e94a">Vectornd</a> &amp;w, <span class="keyword">const</span> <a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a> &amp;p, 
<a name="l00165"></a>00165                      <span class="keywordtype">double</span> h,<span class="keywordtype">int</span> sensor_index,
<a name="l00166"></a>00166                      <a class="code" href="classgcop_1_1LqSensorCost.html#a7a1c771ead648f34c9294d5ecab6e40c">Matrixgxd</a> *dgdw, <a class="code" href="classgcop_1_1LqSensorCost.html#a046f84650db789164e285a3cda2c65a6">Matrixgpd</a> *dgdp,
<a name="l00167"></a>00167                      <a class="code" href="classgcop_1_1LqSensorCost.html#aefe7e59d6db4847e894e9e4bec08d889">Matrixgzd</a> *dgdz)
<a name="l00168"></a>00168     {
<a name="l00169"></a>00169       assert(g.size() == this-&gt;sys.X.n + this-&gt;sys.P.n + this-&gt;Z.n);
<a name="l00170"></a>00170 
<a name="l00171"></a>00171       <span class="keywordtype">int</span> &amp;nw = this-&gt;sys.X.n;
<a name="l00172"></a>00172       <span class="keywordtype">int</span> &amp;nz = this-&gt;Z.n;
<a name="l00173"></a>00173       <span class="keywordtype">int</span> &amp;<a class="code" href="camera_8h.html#a2bae77253fba36eb9bf93d4c45e4ff79">np</a> = this-&gt;sys.P.n;
<a name="l00174"></a>00174 
<a name="l00175"></a>00175       assert(h &gt; 0);
<a name="l00176"></a>00176       <span class="comment">//int k = round(t/h);</span>
<a name="l00177"></a>00177       <span class="keywordflow">if</span> (zs) {
<a name="l00178"></a>00178         assert(sensor_index &lt; zs-&gt;size());
<a name="l00179"></a>00179         this-&gt;Z.Lift(dz, (*zs)[sensor_index], z); <span class="comment">// difference (on a vector space we have dx = x - xf)</span>
<a name="l00180"></a>00180         <span class="comment">//std::cout&lt;&lt;&quot;dz: &quot;&lt;&lt;dz.transpose()&lt;&lt;&quot;\t&quot;&lt;&lt;t&lt;&lt;&quot;\t&quot;&lt;&lt;h&lt;&lt;endl;</span>
<a name="l00181"></a>00181         <span class="comment">//std::cout&lt;&lt;&quot;zs[&quot;&lt;&lt;k&lt;&lt;&quot;]: &quot;&lt;&lt;(*zs)[k].transpose()&lt;&lt;endl;</span>
<a name="l00182"></a>00182         <span class="comment">//std::cout&lt;&lt;&quot;z[&quot;&lt;&lt;k&lt;&lt;&quot;]: &quot;&lt;&lt;z.transpose()&lt;&lt;endl;</span>
<a name="l00183"></a>00183       } 
<a name="l00184"></a>00184       <span class="comment">//cout&lt;&lt;&quot;zs[&quot;&lt;&lt;sensor_index&lt;&lt;&quot;]: &quot;&lt;&lt;(*zs)[sensor_index].transpose()&lt;&lt;&quot;\t&quot;&lt;&lt;z.transpose()&lt;&lt;endl;</span>
<a name="l00185"></a>00185       <span class="comment">//getchar();</span>
<a name="l00186"></a>00186       assert(!std::isnan(dz[0]));
<a name="l00187"></a>00187 
<a name="l00188"></a>00188       <span class="keywordflow">if</span> (diag)
<a name="l00189"></a>00189       {
<a name="l00190"></a>00190         g.head(nw) = Ssqrt.diagonal().cwiseProduct(sqrt(h)*w);
<a name="l00191"></a>00191         g.segment(nw, nz) = Rsqrt.diagonal().cwiseProduct(sqrt(h)*dz);
<a name="l00192"></a>00192   <span class="comment">//     cout&lt;&lt;&quot;w: &quot;&lt;&lt;w.transpose()&lt;&lt;endl;</span>
<a name="l00193"></a>00193       }
<a name="l00194"></a>00194       <span class="keywordflow">else</span>
<a name="l00195"></a>00195       {
<a name="l00196"></a>00196         g.head(nw) = Ssqrt*(sqrt(h)*w);
<a name="l00197"></a>00197         g.segment(nw, nz) = Rsqrt*(sqrt(h)*dz);
<a name="l00198"></a>00198       }
<a name="l00199"></a>00199       g.tail(np).setZero();
<a name="l00200"></a>00200       <span class="comment">//cout&lt;&lt;&quot;g: &quot;&lt;&lt;g.transpose()&lt;&lt;endl;</span>
<a name="l00201"></a>00201 
<a name="l00202"></a>00202       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00203"></a>00203     }
<a name="l00204"></a>00204 
<a name="l00205"></a>00205   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> _nx, <span class="keywordtype">int</span> _nu, <span class="keywordtype">int</span> _np, <span class="keywordtype">int</span> _ng, <span class="keyword">typename</span> Tz, <span class="keywordtype">int</span> _nz&gt;
<a name="l00206"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a829931906d3a2e3c8d979542e088213f">00206</a>     <span class="keywordtype">bool</span> <a class="code" href="classgcop_1_1LqSensorCost.html#a829931906d3a2e3c8d979542e088213f">LqSensorCost&lt;T, _nx, _nu, _np, _ng, Tz, _nz&gt;::Resp</a>(<a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a> &amp;gp, 
<a name="l00207"></a>00207                                                             <span class="keyword">const</span> <a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a> &amp;p,
<a name="l00208"></a>00208                                                             <a class="code" href="classgcop_1_1LqSensorCost.html#a83c9f189479594ddfa891136aca91bf0">Matrixmd</a> *dgdp)
<a name="l00209"></a>00209     {
<a name="l00210"></a>00210       <span class="keywordflow">if</span> (mup) {
<a name="l00211"></a>00211         dp = p - *mup;<span class="comment">//Error</span>
<a name="l00212"></a>00212       }
<a name="l00213"></a>00213       <span class="keywordflow">else</span>
<a name="l00214"></a>00214         dp  = p;
<a name="l00215"></a>00215 
<a name="l00216"></a>00216       <span class="keywordflow">if</span>(diag)
<a name="l00217"></a>00217       {
<a name="l00218"></a>00218         gp = Psqrt.diagonal().cwiseProduct(dp);
<a name="l00219"></a>00219       }
<a name="l00220"></a>00220       <span class="keywordflow">else</span>
<a name="l00221"></a>00221       {
<a name="l00222"></a>00222         gp = Psqrt*dp;
<a name="l00223"></a>00223       }
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> _nx, <span class="keywordtype">int</span> _nu, <span class="keywordtype">int</span> _np, <span class="keywordtype">int</span> _ng, <span class="keyword">typename</span> Tz, <span class="keywordtype">int</span> _nz&gt;
<a name="l00227"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a22505a726294202e0a08dbeed89c079b">00227</a>     <span class="keywordtype">double</span> <a class="code" href="classgcop_1_1LqSensorCost.html#a22505a726294202e0a08dbeed89c079b">LqSensorCost&lt;T, _nx, _nu, _np, _ng, Tz, _nz&gt;::L</a>(<span class="keywordtype">double</span> t, <span class="keyword">const</span> Tz &amp;z, <span class="keyword">const</span> <a class="code" href="classgcop_1_1LqSensorCost.html#a3c6ac29844b0ef8a974e4e9bac14e94a">Vectornd</a> &amp;w,
<a name="l00228"></a>00228                                                            <span class="keyword">const</span> <a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a> &amp;p, <span class="keywordtype">double</span> h, <span class="keywordtype">int</span> sensor_index,
<a name="l00229"></a>00229                                                            <a class="code" href="classgcop_1_1LqSensorCost.html#a3c6ac29844b0ef8a974e4e9bac14e94a">Vectornd</a> *Lw, <a class="code" href="classgcop_1_1LqSensorCost.html#a647a927eb52363a70d55f80c9bc75d38">Matrixnd</a>* Lww,
<a name="l00230"></a>00230                                                            <a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a> *Lp, <a class="code" href="classgcop_1_1LqSensorCost.html#a83c9f189479594ddfa891136aca91bf0">Matrixmd</a>* Lpp,
<a name="l00231"></a>00231                                                            <a class="code" href="classgcop_1_1LqSensorCost.html#a3de9b3f07cce0167cf38c3bb54cb4469">Vectorrd</a> *Lz, <a class="code" href="classgcop_1_1LqSensorCost.html#a29de4b9a3ba7fee5f99d9a688f0ebabd">Matrixrd</a>* Lzz,
<a name="l00232"></a>00232                                                            <a class="code" href="classgcop_1_1LqSensorCost.html#a0b1b320c10a6b7106c0eb332c71f6df1">Matrixmnd</a> *Lpw, <a class="code" href="classgcop_1_1LqSensorCost.html#ac18c481007159515d25ca5e26aa52c39">Matrixrnd</a>* Lzw, <a class="code" href="classgcop_1_1LqSensorCost.html#aac44a5660c6663f41f31c7303873ad97">Matrixrmd</a>* Lzp)
<a name="l00233"></a>00233     {
<a name="l00234"></a>00234       <span class="comment">//int k = (int)(t/h);</span>
<a name="l00235"></a>00235 
<a name="l00236"></a>00236       <span class="keywordflow">if</span> (zs) {
<a name="l00237"></a>00237         assert(sensor_index &lt; zs-&gt;size());
<a name="l00238"></a>00238         this-&gt;Z.Lift(dz, (*zs)[sensor_index], z); <span class="comment">// difference (on a vector space we have dx = x - xf)</span>
<a name="l00239"></a>00239       } 
<a name="l00240"></a>00240       assert(!std::isnan(dz[0]));
<a name="l00241"></a>00241 
<a name="l00242"></a>00242       <span class="keywordflow">if</span> (Lz)
<a name="l00243"></a>00243         <span class="keywordflow">if</span> (diag)
<a name="l00244"></a>00244           *Lz = R.diagonal().cwiseProduct(h*dz);
<a name="l00245"></a>00245         <span class="keywordflow">else</span>
<a name="l00246"></a>00246           *Lz = R*(h*dz);
<a name="l00247"></a>00247 
<a name="l00248"></a>00248       <span class="keywordflow">if</span> (Lzz) 
<a name="l00249"></a>00249         *Lzz = h*R;
<a name="l00250"></a>00250 
<a name="l00251"></a>00251       <span class="keywordflow">if</span> (Lw)
<a name="l00252"></a>00252         <span class="keywordflow">if</span> (diag)
<a name="l00253"></a>00253           *Lw = S.diagonal().cwiseProduct(h*w);
<a name="l00254"></a>00254         <span class="keywordflow">else</span>
<a name="l00255"></a>00255           *Lw = S*(h*w);        
<a name="l00256"></a>00256 
<a name="l00257"></a>00257       <span class="keywordflow">if</span> (Lww)
<a name="l00258"></a>00258         *Lww = h*S;
<a name="l00259"></a>00259 
<a name="l00260"></a>00260       <span class="keywordflow">if</span>(Lp)
<a name="l00261"></a>00261         Lp-&gt;setZero();
<a name="l00262"></a>00262 
<a name="l00263"></a>00263       <span class="keywordflow">if</span>(Lpp)
<a name="l00264"></a>00264         Lpp-&gt;setZero();
<a name="l00265"></a>00265 
<a name="l00266"></a>00266       <span class="keywordflow">if</span> (Lzw)
<a name="l00267"></a>00267         Lzw-&gt;setZero();
<a name="l00268"></a>00268 
<a name="l00269"></a>00269       <span class="keywordflow">if</span>(Lzp)
<a name="l00270"></a>00270         Lzp-&gt;setZero();
<a name="l00271"></a>00271 
<a name="l00272"></a>00272       <span class="keywordflow">if</span>(Lpw)
<a name="l00273"></a>00273         Lpw-&gt;setZero();
<a name="l00274"></a>00274 
<a name="l00275"></a>00275       <span class="keywordflow">if</span> (diag)
<a name="l00276"></a>00276         <span class="keywordflow">return</span> h*(dz.dot(R.diagonal().cwiseProduct(dz))/2 + w.dot(S.diagonal().cwiseProduct(w)))/2;
<a name="l00277"></a>00277       <span class="keywordflow">else</span>
<a name="l00278"></a>00278         <span class="keywordflow">return</span> h*(dz.dot(R*dz) + w.dot(S*w))/2;
<a name="l00279"></a>00279       <span class="keywordflow">return</span> 0;
<a name="l00280"></a>00280     }  
<a name="l00281"></a>00281 
<a name="l00282"></a>00282   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> _nx, <span class="keywordtype">int</span> _nu, <span class="keywordtype">int</span> _np, <span class="keywordtype">int</span> _ng, <span class="keyword">typename</span> Tz, <span class="keywordtype">int</span> _nz&gt;
<a name="l00283"></a><a class="code" href="classgcop_1_1LqSensorCost.html#a6d8bfcdafd068c8fdc71d0676ed1ff73">00283</a>     <span class="keywordtype">double</span> <a class="code" href="classgcop_1_1LqSensorCost.html#a6d8bfcdafd068c8fdc71d0676ed1ff73">LqSensorCost&lt;T, _nx, _nu, _np, _ng, Tz, _nz&gt;::Lp</a>(<span class="keyword">const</span> <a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a> &amp;p,
<a name="l00284"></a>00284                                                             <a class="code" href="classgcop_1_1LqSensorCost.html#a0ba93a3ce7c4cde4a28a8deac5f08754">Vectormd</a> *Lp, <a class="code" href="classgcop_1_1LqSensorCost.html#a83c9f189479594ddfa891136aca91bf0">Matrixmd</a> *Lpp)
<a name="l00285"></a>00285     {
<a name="l00286"></a>00286       <span class="keywordflow">if</span>(mup)
<a name="l00287"></a>00287         dp = p - *mup;
<a name="l00288"></a>00288       <span class="keywordflow">else</span>
<a name="l00289"></a>00289         dp = p;
<a name="l00290"></a>00290 
<a name="l00291"></a>00291       <span class="keywordflow">if</span> (Lp)
<a name="l00292"></a>00292         <span class="keywordflow">if</span> (diag)
<a name="l00293"></a>00293           *Lp = P.diagonal().cwiseProduct(dp);
<a name="l00294"></a>00294         <span class="keywordflow">else</span>
<a name="l00295"></a>00295           *Lp = P*dp;        
<a name="l00296"></a>00296 
<a name="l00297"></a>00297       <span class="keywordflow">if</span> (Lpp)
<a name="l00298"></a>00298         *Lpp = P;
<a name="l00299"></a>00299 
<a name="l00300"></a>00300       <span class="keywordflow">if</span> (diag)
<a name="l00301"></a>00301         <span class="keywordflow">return</span> dp.dot(P.diagonal().cwiseProduct(dp))/2;
<a name="l00302"></a>00302       <span class="keywordflow">else</span>
<a name="l00303"></a>00303         <span class="keywordflow">return</span> dp.dot(P*dp)/2;
<a name="l00304"></a>00304     }
<a name="l00305"></a>00305 
<a name="l00306"></a>00306 }
<a name="l00307"></a>00307 
<a name="l00308"></a>00308 
<a name="l00309"></a>00309 <span class="preprocessor">#endif</span>
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Wed May 13 2015 21:58:47 for GCOP by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
